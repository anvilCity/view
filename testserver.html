<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <script src="https://js.pusher.com/3.0/pusher.min.js"></script>
    <script src="https://cdn.rawgit.com/leggetter/pusher-js-client-auth/master/dist/pusher-js-client-auth.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>

    <script>
      Pusher.log = function(message) {
        if (window.console && window.console.log) {
          window.console.log(message);
        }
      };

      var APP_KEY = "479c59972bf192be9acf";
      var APP_SECRET = "19889e3337268d47f4a5";

      var pusher = new Pusher(APP_KEY, {
      authTransport: 'client',
      clientAuth: {
        key: APP_KEY,
        secret: APP_SECRET,
        cluster: 'eu',
        encrypted: true,
        user_id: '1',
        user_info: {}
      }
      });

      var channel = pusher.subscribe('presence-pool');



      channel.bind('pusher:subscription_succeeded', function(){
        var dummyData = [
            {
                key: "Apple",
                value: 317,
                avgSentiment: 0.8
            },
            {
                key: "Twitter",
                value: 56,
                avgSentiment: 0.5
            },
            {
                key: "Microsoft",
                value: 172,
                avgSentiment: 0.1
            },
            {
                key: "Oracle",
                value: 3,
                avgSentiement: 0.9
            },
            {
                key: "Google",
                value: 817,
                avgSentiment: 0.3
            },
            {
                key: "MLH",
                value: 43,
                avgSentiment: 0.95
            }
        ];
        setInterval(function() {
            dummyData.forEach(function (elem) {
                console.log(elem);
                elem.avgSentiment = Math.abs(elem.avgSentiment + (Math.random() - 0.5) / 10);
                elem.value = Math.abs(elem.value + (Math.random() - 0.5) * 10);
            });
            channel.trigger('client-new_data', dummyData);
        }, 10000);
      });
      
    </script>







    <title>mock server</title>
  </head>
  <body>
    <h1>Hello World!</h1>
  </body>
</html>
